import socket


skt = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
# Servidor sem IP para escutar localmente
server = ('', 1337)  # tupla (ip,port)
# bind -> Cria um servidor
skt.bind(server)

# deixa escutando e ativo para conexao
skt.listen(10)
while True:
    # Enquanto skt.accept() nao recebe conexao ele nao executa o codigo em baixo
    client, endereco = skt.accept()  # ->Retorna uma tupla ( Endereco , Cliente)
    # Print msg no endereco do cliente
    print(f"Cliente {endereco} se conectou!")

    # Printa msg no terminal do servidor
    # recv(1024)decode() -> recebe dados do cliente
    recebido = client.recv(1024).decode()
    # pega os primeiros 1024 bytes da mensagem
    # e fazemos Byte -> String
    print(f"Recebido: {recebido}")

    # Basicamente um echo reply simples a seguir
    if recebido == 'Oi servidor\n':
        client.send(b"Oi de volta\n")
    client.close()
    # apos enviar a msg ele fecha a conex√£o e volta pro skt.accept escutando denovo
